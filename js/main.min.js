let familyNum,searchVal,lastChar,family=[],counter=1,lang=1,now=new Date,currentYear=now.getFullYear(),sortBtnCounter=1,birthdayArr=[],birthdayToday=!1;const hebCalendarUrl="https://www.hebcal.com/converter?cfg=json";function showResult(e,t){for(let a=0;a<$(e).length;a++){let r,n,s,o=$($(e)[a]).attr("name").toLowerCase(),i=$($(e)[a]).attr("nameHeb"),l=$($(e)[a]).attr("img"),p=$("#search").val(),c=p.charAt(0).toUpperCase()+p.slice(1);r=1==lang?o.toUpperCase():i.toUpperCase();try{n=1==lang?capitalize(o):i,s=capitalize(c)}catch(e){return}if(n.includes(s)||n.includes(s.toLowerCase())||i.includes(s)){let e=$("<div>",{class:"result",id:t,click:function(){let e=$(this).attr("id");$.each($(".container .personWrapper"),function(t,a){if($(this).attr("numId")==e){$("body").css("pointer-events","none");let e=this;$("#searchResults").hide(),$("#search").val(""),1==$(this).attr("isParent")?goToDiv($(this).parent().parent()):goToDiv($(this).parent()),setTimeout(function(){$(e).click(),$("body").css("pointer-events","all")},1500)}})}}).appendTo($("#searchResults")),a=$("<div>",{class:"resultImgWrapper"}).appendTo(e);$("<img>",{class:"resultImg",src:"./images/people"+l}).appendTo(a),$("<p>",{class:"resultName",text:n}).appendTo(e)}0==p.length||$(".result").length<1||""==p?$("#searchResults").hide():$("#searchResults").show()}}function sort(){1==sortBtnCounter?($(".sortContainer").fadeIn("fast"),sortBtnCounter=2):($(".sortContainer").fadeOut("fast"),sortBtnCounter=1)}function showFamily(e){$(".closestBirth, .birthdayWish").remove(),birthdayToday&&$(".personWrapper").first().remove(),$(".container").empty(),$(".closestBirth").html(""),$(".birthdayWish").html(""),family=[],counter=1,birthdayToday=!1,$(".btnWrapper").css("opacity",0),$(".spinnerWrapper").show(),setTimeout(function(){switch(e){case 1:loadJson("./lists/shalevs.txt"),familyNum=1;break;case 2:loadJson("./lists/waizingers.txt"),familyNum=2;break;case 3:loadJson("./lists/alayevs.txt"),familyNum=3}},500),$(".sortContainer").fadeOut("fast"),sortBtnCounter=1}function loadJson(e){$.get(e,function(e){family.push(JSON.parse(e)),setTimeout(function(){buildPeople("familyWrapper",$(".container"),family),$("body").css("background-image","linear-gradient(180deg,rgba(200, 200, 200, .95), rgba(50,50,50,.95))")},500)})}function goToDiv(e){$("html, body").animate({scrollTop:$(e).position().top-170},1500)}function buildPeople(e,t,a){var r,n=a[0].family,s=(u=new Date).getFullYear();let o;for(var i=0;i<n.length;i++){var l,p,c=JSON.stringify(n[i].group),h=c.substring(0,c.indexOf("."));if($(l).hasClass("group"+h));else{l=$("<div>",{class:"group"+h+" groupWrapper"}).appendTo(t);var d=$("<div>",{class:"parentDiv"}).appendTo(l);h%2==0?$(l).addClass("evenGroup"):$(l).addClass("oddGroup")}p=1==lang?n[i].name:n[i].nameHeb;var u,g=new Date,m=(g.getMonth(),g.getFullYear()),b=(u=new Date(n[i].birthday)).getDate(),y=u.getMonth()+1,f=u.getFullYear();b=b<10?"0"+b:b,y=y<10?"0"+y:y;var w=new Date(n[i].deathDate),T=w.getDate(),v=w.getMonth()+1,k=y+"/"+b,W=b+"/"+y+"/"+f,C=(T=T<10?"0"+T:T)+"/"+(v=v<10?"0"+v:v)+"/"+w.getFullYear(),B=$("<div>",{class:"personWrapper",numId:n[i].id,birthday:n[i].birthday,name:n[i].name,nameHeb:n[i].nameHeb,group:n[i].group,img:n[i].image,isParent:n[i].parent,married:n[i].married,gender:n[i].gender,facebook:n[i].facebook,instagram:n[i].instagram,calendar:k,year:f,deathDate:n[i].deathDate,afterSunset:n[i].afterSunset,click:function(){switch("null"==$(this).attr("facebook")?$("#facebookLink").hide():($("#facebookLink").show(),$("#facebookLink").attr("href","https://www.facebook.com"+$(this).attr("facebook"))),"null"==$(this).attr("instagram")?$("#instagramLink").hide():($("#instagramLink").show(),$("#instagramLink").attr("href","https://www.instagram.com"+$(this).attr("instagram"))),$("#checkBirthdaysLink").attr("href","https://omriknight9.github.io/birthdays?name="+$(this).attr("name")+"&day="+$(this).attr("day")+"&month="+$(this).attr("month")),1==lang?$(".personNamePop").html($(this).attr("name")):$(".personNamePop").html($(this).attr("nameHeb")),$("#personCover").attr("src","./images/people"+$(this).attr("img")),$(".start").html($(this).attr("calendar")+"08:00 AM"),$(".end").html($(this).attr("calendar")+"10:00 AM"),1==lang?($(".title").html($(this).attr("name")+"'s Birthday"),$(".location").html($(this).attr("name")+"'s Home"),$(".nextBirthday").html("Next Birthday Will Be On "+$(this).attr("nextBirthday"))):($(".title").html("יומולדת ל"+$(this).attr("nameHeb")),$(".location").html("הבית של "+$(this).attr("nameHeb")),$(".nextBirthday").html("היומולדת הבא יהיה ביום "+$(this).attr("nextBirthday"))),$(".hebBirthday").html(""),$(this).attr("afterSunset")){case"true":$.get(hebCalendarUrl+`&gy=${$(this).attr("year")}&gm=${$(this).attr("month")}&gd=${$(this).attr("day")}&2h=1&gs=on`,function(e){$(".hebBirthday").html(e.hebrew)});break;case"false":$.get(hebCalendarUrl+`&gy=${$(this).attr("year")}&gm=${$(this).attr("month")}&gd=${$(this).attr("day")}&2h=1`,function(e){$(".hebBirthday").html(e.hebrew)});break;case"null":$.get(hebCalendarUrl+`&gy=${$(this).attr("year")}&gm=${$(this).attr("month")}&gd=${$(this).attr("day")}&2h=1`,function(e){$(".hebBirthday").html(e.hebrew)}),$.get(hebCalendarUrl+`&gy=${$(this).attr("year")}&gm=${$(this).attr("month")}&gd=${$(this).attr("day")}&2h=1&gs=on`,function(e){$(".hebBirthday").append("/"+e.hebrew)})}$("#personDetails").fadeIn(150),1==$(this).attr("gender")?$("#personDetails .popupCont").css("background-color","lightblue"):$("#personDetails .popupCont").css("background-color","pink")}});let e,a,I;1==$(B).attr("gender")?(e="male.webp",$(B).addClass("boy"),a="0"==b.toString().charAt(0)?b.replace("0",""):b,I="0"==y.toString().charAt(0)?y.replace("0",""):y,a==now.getDate()&&now.getMonth()+1==I&&$(B).addClass("boyBornToday")):(e="female.webp",$(B).addClass("girl"),a="0"==b.toString().charAt(0)?b.replace("0",""):b,I="0"==y.toString().charAt(0)?y.replace("0",""):y,a==now.getDate()&&now.getMonth()+1==I&&$(B).addClass("girlBornToday")),1==lang?("null"!==n[i].deathDate&&(o="Death Date: "),r="Birthday: "):("null"!==n[i].deathDate&&(o="תאריך פטירה: "),r="יומולדת: ");$("<img>",{class:"genderImg",src:"./images/"+e,alt:"gender img"}).appendTo(B);let N;switch(y){case"01":case 1:N=b<20?"/capricorn.webp":"/aquarius.webp";break;case"02":case 2:N=b<19?"/aquarius.webp":"/pisces.webp";break;case"03":case 3:N=b<21?"/pisces.webp":"/aries.webp";break;case"04":case 4:N=b<20?"/aries.webp":"/taurus.webp";break;case"05":case 5:N=b<21?"/taurus.webp":"/gemini.webp";break;case"06":case 6:N=b<21?"/gemini.webp":"/cancer.webp";break;case"07":case 7:N=b<23?"/cancer.webp":"/leo.webp";break;case"08":case 8:N=b<23?"/leo.webp":"/virgo.webp";break;case"09":case 9:N=b<23?"/virgo.webp":"/libra.webp";break;case"10":case 10:N=b<23?"/libra.webp":"/scorpio.webp";break;case"11":case 11:N=b<22?"/scorpio.webp":"/sagittarius.webp";break;case"12":case 12:N=b<22?"/sagittarius.webp":"/capricorn.webp"}$("<img>",{class:"zodiacImg",src:"./images/zodiac"+N,alt:"zodiac img"}).appendTo(B);var D=m-f;1==$(B).attr("isParent")?($(B).appendTo(d),1==$(B).attr("gender")?($(B).addClass("suit"),buildCloths("suitImg","suit","suit img",B)):buildCloths("dressImg","dress","dress img",B)):(1==$(B).attr("gender")?D<5?buildCloths("babyBoyImg","babyBoy","baby boy img",B):1==$(B).attr("married")?buildCloths("suitImg","suit","suit img",B):buildCloths("boyImg","boy","boy img",B):D<5?buildCloths("babyGirlImg","babyGirl","baby girl img",B):1==$(B).attr("married")?buildCloths("dressImg","dress","dress img",B):buildCloths("girlImg","girl","girl img",B),$(B).appendTo(l)),new Date($(B).attr("calendar")+"/"+s)<now?$(B).attr("calendar",$(B).attr("calendar")+"/"+Number(s+1)):$(B).attr("calendar",$(B).attr("calendar")+"/"+s);var x=$("<div>",{class:"personDetailsWrapper"}).appendTo(B);$("<p>",{class:"personName",text:p}).appendTo(x),$("<p>",{class:"personBirthday",text:r+W}).appendTo(x);if("null"!==n[i].deathDate)$("<p>",{class:"personDeathDay",text:o+C}).appendTo(x);var A=$("<div>",{class:"personImgWrapper"}).appendTo(B);$("<img>",{class:"personImg",alt:"personImg",src:"./images/people"+n[i].image}).appendTo(A)}setTimeout(function(){checkAge(),checkClosest(),$(".btnWrapper").css("opacity",1),$(".spinnerWrapper").hide()},0)}function checkClosest(){let e;birthdayArr=[];for(let a=0;a<$(".groupWrapper .personWrapper").length;a++){let r=$($(".groupWrapper .personWrapper")[a]).attr("name"),n=$($(".groupWrapper .personWrapper")[a]).attr("nameHeb"),s=$($(".groupWrapper .personWrapper")[a]).attr("day"),o=$($(".groupWrapper .personWrapper")[a]).attr("month"),i=$($(".groupWrapper .personWrapper")[a]).attr("gender"),l=$($(".groupWrapper .personWrapper")[a]).attr("img"),p=new Date(now.getFullYear()+"/"+o+"/"+s);now.getDate()==s&&now.getMonth()+1==o?(e=now.getFullYear(),birthdayToday=!0):e=p<now?now.getFullYear()+1:now.getFullYear();var t=new Date(e+"/"+o+"/"+s);"null"==$($(".groupWrapper .personWrapper")[a]).attr("deathDate")&&birthdayArr.push({name:r,gender:i,nameHeb:n,date:t,img:l})}setTimeout(function(){if(birthdayArr.sort(function(e,t){return Math.abs(now-e.date)-Math.abs(now-t.date)}),1==lang){let e;if(birthdayToday)$.each($(".personWrapper"),function(t,a){$(a).attr("month")==now.getMonth()+1&&$(a).attr("day")==now.getDate()&&($(a).clone().appendTo($("#birthdayToday")),e=1==$(a).attr("gender")?1:2)}),$.each($("#birthdayToday .personWrapper"),function(e,t){let a=$("<p>",{class:"closestBirth",text:"It's "}).insertAfter($(".spinnerWrapper")),r=$("<span>",{class:"birthdayColor",text:birthdayArr[e].name}).appendTo(a),n=($("<span>",{class:"closestSpan",text:"'s Birthday Today!"}).appendTo(a),$("<p>",{class:"birthdayWish"}).insertAfter(a));if("null"!==$(t).attr("facebook")){let a;a=1==birthdayArr[e].gender?"Wish Him Happy Birthday":"Wish Her Happy Birthday";$("<a>",{href:"https://www.facebook.com"+$(t).attr("facebook"),target:"_blank",text:a}).appendTo(n)}$(t).click(function(){goToBirthdayPerson($(t).attr("numid"))}),1==birthdayArr[e].gender?$(r).css("color","lightblue"):$(r).css("color","pink")});else{let e=$("<p>",{class:"closestBirth",text:"Closest Birthday: "}).insertAfter($(".spinnerWrapper"));$("<span>",{class:"birthdayColor",text:birthdayArr[0].name}).appendTo(e);1==birthdayArr[0].gender?$(".birthdayColor").css("color","lightblue"):$(".birthdayColor").css("color","pink"),$(window).width()>765&&($(".closestBirth").mouseenter(function(){if(!$("#searchResults").is(":visible")){let e=$("<div>",{class:"hoverImgContainer"}).hide().appendTo($(".closestBirth")).fadeIn(),t=$("<div>",{class:"hoverImgWrapper"}).appendTo(e);$("<img>",{class:"hoverImg",src:"./images/people"+birthdayArr[0].img}).appendTo(t)}}),$(".closestBirth").mouseleave(function(){$(".hoverImgContainer").fadeOut(400),$(".closestBirth").css("pointer-events","none"),setTimeout(function(){$(".hoverImgContainer").remove(),$(".closestBirth").css("pointer-events","all")},600)}).mouseleave())}}else{let e;if(birthdayToday)$.each($(".personWrapper"),function(t,a){$(a).attr("month")==now.getMonth()+1&&$(a).attr("day")==now.getDate()&&($(a).clone().appendTo($("#birthdayToday")),e=1==$(a).attr("gender")?1:2)}),$.each($("#birthdayToday .personWrapper"),function(e,t){let a=$("<p>",{class:"closestBirth"}).insertAfter($(".spinnerWrapper")),r=$("<span>",{class:"birthdayColor",text:birthdayArr[e].nameHeb}).appendTo(a),n=($("<span>",{class:"closestSpan",text:" חוגג היום!"}).appendTo(a),$("<p>",{class:"birthdayWish"}).insertAfter(a));if("null"!==$(t).attr("facebook"))$("<a>",{href:"https://www.facebook.com"+$(t).attr("facebook"),target:"_blank",text:"אחל/י לו יום הולדת שמח"}).appendTo(n);$(t).click(function(){goToBirthdayPerson($(t).attr("numid"))}),1==birthdayArr[e].gender?$(r).css("color","lightblue"):$(r).css("color","pink")});else{let e=$("<p>",{class:"closestBirth",text:"החוגג הקרוב: "}).insertAfter($(".spinnerWrapper"));$("<span>",{class:"birthdayColor",text:birthdayArr[0].nameHeb}).appendTo(e);1==birthdayArr[0].gender?$(".birthdayColor").css("color","lightblue"):$(".birthdayColor").css("color","pink"),$(window).width()>765&&($(".closestBirth").mouseenter(function(){if(!$("#searchResults").is(":visible")){let e=$("<div>",{class:"hoverImgContainer"}).hide().appendTo($(".closestBirth")).fadeIn(),t=$("<div>",{class:"hoverImgWrapper"}).appendTo(e);$("<img>",{class:"hoverImg",src:"./images/people"+birthdayArr[0].img}).appendTo(t)}}),$(".closestBirth").mouseleave(function(){$(".hoverImgContainer").fadeOut(400),$(".closestBirth").css("pointer-events","none"),setTimeout(function(){$(".hoverImgContainer").remove(),$(".closestBirth").css("pointer-events","all")},600)}).mouseleave())}}},1e3)}function goToBirthdayPerson(e){$.each($(".container .personWrapper"),function(t,a){$(a).attr("numId")==e&&$(a).click()})}function checkAge(){$.each($(".personWrapper"),function(e,t){"null"==$(t).attr("deathDate")?getAge($(t),$(t).attr("birthday"),$(t).attr("calendar")):getDeathAge($(t),$(t).attr("deathdate"),$(t).attr("birthday"))})}function buildCloths(e,t,a,r){$("<img>",{class:"clothesImg",id:t,src:"./images/"+t+".webp",alt:a}).appendTo(r)}function getDeathAge(e,t,a){var r,n=new Date(t),s=new Date(a),o=n.getFullYear()-s.getFullYear();n.getMonth(),s.getMonth();r=1==lang?"Died: "+o:" נפטר בגיל: "+o;$("<p>",{class:"personAge",text:r}).appendTo($(e).find($(".personDetailsWrapper")))}function getAge(e,t,a){var r,n=new Date,s=new Date(t),o=new Date(a),i=n.getFullYear()-s.getFullYear(),l=n.getMonth()-s.getMonth(),p=o.getMonth()+1,c=o.getDate(),h=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d=["ראשון","שני","שלישי","רביעי","חמישי","שישי","שבת"];if(l<0||0===l&&n.getDate()<s.getDate()?(1==lang?$(e).attr("nextBirthday",h[o.getDay()]):$(e).attr("nextBirthday",d[o.getDay()]),i--):(o.setFullYear(o.getFullYear()),1==lang?$(e).attr("nextBirthday",h[o.getDay()]):$(e).attr("nextBirthday",d[o.getDay()])),0==i){let e,a,r,s=(a=n.getMonth()+1<10?"0"+Math.round(n.getMonth()+1):n.getMonth()+1)+"/"+(r=n.getDate()<10?"0"+Math.round(n.getDate()):n.getDate())+"/"+n.getFullYear();const o=new Date(t),l=new Date(s);e=12*(l.getFullYear()-o.getFullYear())+(l.getMonth()-o.getMonth()),i=1==lang?e+" Months":e+" חודשים"}$(e).attr("age",i),$(e).attr("month",p),$(e).attr("day",c),r=1==lang?"Age: ":"גיל: ";$("<p>",{class:"personAge",text:r+i}).appendTo($(e).find($(".personDetailsWrapper")));return i}function goToTop(){$("html,body").animate({scrollTop:0},"slow")}function scrollBtn(){$(this).scrollTop()>550?$(".goToTopBtn").fadeIn():$(".goToTopBtn").fadeOut()}function sortFamily(e,t){$(".groupWrapper").removeClass("oddGroup"),$(".groupWrapper").removeClass("evenGroup"),"calendar"==e||$(".btnWrapper").attr("kind")==t||($(".btnWrapper").attr("kind",t),counter=1),3==t&&$(".container").empty(),2==lang&&"name"==e&&(e="nameHeb"),$.each($(".container"),function(a,r){var n,s,o,i=[],l=$(this).find(".personWrapper");for(s=0,o=l.length;s<o;s++){(n={}).element=l[s];var p=$(l[s]).attr(e);switch(t){case 1:n.idNum=new Date(p);break;case 2:n.idNum=p;break;case 3:n.idNum=parseInt(p.replace(/[^\d]/g,""),10)}i.push(n)}switch(t){case 1:switch(counter){case 1:i.sort(function(e,t){return t.idNum-e.idNum}),counter=2;break;case 2:i.sort(function(e,t){return e.idNum-t.idNum}),counter=1}$(".btnWrapper").attr("kind",t),$(".groupSortBtn").css("pointer-events","all");break;case 2:switch(counter){case 1:i.sort(function(e,t){return e.idNum.localeCompare(t.idNum)}),counter=2;break;case 2:i.sort(function(e,t){return t.idNum.localeCompare(e.idNum)}),counter=1}$(".btnWrapper").attr("kind",t),$(".groupSortBtn").css("pointer-events","all");break;case 3:$(".closestBirth").html(""),$(".birthdayWish").html(""),birthdayToday&&$(".personWrapper").first().remove(),$("body").css("background-image","unset"),$(".spinnerWrapper").show(),$(".btnWrapper").css("opacity",0),$(".groupSortBtn").css("pointer-events","none"),showFamily(familyNum),setTimeout(function(){$(".btnWrapper").css("opacity",1),$(".spinnerWrapper").hide()},500)}for(s=0;s<i.length;s++)$(this).append(i[s].element)}),$(".sortContainer").fadeOut("fast"),sortBtnCounter=1}function removePopup(e){$(document).mouseup(function(t){e.is(t.target)&&0===e.has(t.target).length&&(e.hide(),t.stopPropagation(),$(document).off("mouseup"))})}function closeCurrentPopup(e){$($(e)[0].parentElement.parentElement.parentElement).fadeOut(150)}function capitalize(e){e=e.split(" ");for(let t=0;t<e.length;t++)e[t]=e[t][0].toUpperCase()+e[t].substr(1);return e.join(" ")}$(document).ready(function(e){window.location.href.indexOf("shalevs")>-1?loadJson("./lists/shalevs.txt"):window.location.href.indexOf("waizingers")>-1?(loadJson("./lists/waizingers.txt"),familyNum=2):window.location.href.indexOf("alayevs")>-1?(loadJson("./lists/alayevs.txt"),familyNum=3):(loadJson("./lists/shalevs.txt"),familyNum=1),window.location.href.indexOf("lang=he")>-1&&setTimeout(function(){changeToHeb(),window.history.pushState("page2","Title","index.html")},600),$("#langBtnHe").click(function(){changeToHeb(),$("#search").val(""),$("#searchResults").hide(),birthdayToday&&$(".personWrapper").first().remove()}),$("#langBtnEn").click(function(){changeToEng(),$("#search").val(""),$("#searchResults").hide(),birthdayToday&&$(".personWrapper").first().remove()}),window.onbeforeunload=function(){window.scrollTo(0,0)},window.onscroll=function(){scrollBtn()},$(".Xbtn").click(function(){$(this).parent().parent().fadeOut(150)}),setTimeout(function(){$(".spinnerWrapper").hide(),$(".searchContainer").show(),$(".btnWrapper").css("opacity",1)},1500),$("#search").on("input",function(){searchVal=$("#search").val()," "!=(lastChar=searchVal.substr(searchVal.length-1))&&($("#searchResults").empty(),$("#searchResults").hide(),$.each($(".container .personWrapper"),function(e,t){let a=$(t).attr("numId");showResult($(this),a)}))})});
